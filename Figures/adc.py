import matplotlib.pyplot as plt
import scienceplots
plt.style.use(['science','grid'])
plt.figure(figsize=(8, 2))

samples = [
    55, 47, 48, 52, 47, 55, 49, 47, 47, 54, 47, 55, 47, 55, 55, 55, 55, 53, 55, 59, 60, 55, 56, 59, 59, 60, 43, 58, 55, 59, 
    57, 55, 63, 59, 55, 59, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63, 62, 71, 63, 63, 
    71, 71, 63, 63, 63, 71, 67, 75, 71, 71, 78, 75, 63, 63, 69, 75, 63, 71, 71, 71, 71, 71, 73, 71, 69, 71, 71, 63, 71, 71, 
    71, 79, 79, 75, 79, 79, 79, 79, 79, 79, 79, 79, 87, 81, 79, 79, 79, 81, 79, 87, 79, 79, 79, 79, 85, 79, 79, 87, 83, 82, 
    83, 83, 87, 87, 83, 87, 87, 92, 87, 87, 93, 91, 91, 92, 87, 93, 91, 95, 95, 92, 88, 93, 95, 95, 95, 95, 96, 95, 95, 95, 
    95, 95, 95, 95, 95, 98, 103, 98, 95, 95, 95, 95, 95, 100, 103, 101, 95, 103, 103, 97, 103, 103, 103, 105, 103, 103, 103, 
    103, 105, 103, 99, 105, 107, 103, 100, 103, 110, 111, 111, 111, 111, 105, 107, 111, 111, 111, 104, 104, 111, 110, 119, 
    111, 111, 111, 109, 111, 111, 116, 119, 116, 110, 119, 119, 118, 117, 111, 117, 112, 111, 119, 119, 120, 111, 119, 119, 
    115, 116, 120, 123, 119, 123, 119, 126, 121, 127, 127, 127, 127, 127, 126, 127, 127, 127, 127, 127, 127, 127, 127, 127, 
    127, 127, 127, 127, 127, 127, 127, 127, 127, 127, 131, 127, 127, 133, 135, 127, 127, 138, 135, 127, 127, 127, 127, 127, 
    127, 133, 135, 127, 135, 142, 135, 142, 127, 127, 141, 127, 138, 135, 143, 136, 140, 143, 135, 141, 137, 139, 135, 143, 
    142, 135, 143, 143, 143, 143, 143, 143, 144, 141, 143, 150, 137, 143, 139, 135, 137, 149, 143, 143, 143, 144, 150, 143, 
    147, 143, 153, 143, 155, 151, 145, 151, 151, 151, 151, 156, 143, 159, 153, 152, 158, 159, 159, 159, 159, 159, 159, 159, 
    159, 159, 159, 159, 159, 159, 161, 159, 167, 165, 159, 159, 159, 159, 157, 155, 159, 159, 165, 160, 167, 166, 168, 167, 
    166, 159, 163, 168, 171, 167, 168, 169, 166, 167, 167, 174, 167, 171, 165, 167, 171, 171, 167, 172, 171, 168, 169, 167, 
    175, 177, 171, 175, 173, 175, 173, 175, 189, 175, 181, 183, 177, 177, 182, 175, 178, 179, 181, 175, 183, 177, 175, 179, 
    177, 175, 183, 191, 183, 191, 188, 183, 184, 191, 189, 183, 184, 191, 183, 191, 191, 191, 191, 191, 191, 191, 191, 191, 
    191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 191, 199, 196, 191, 191, 191, 187, 191, 191, 
    191, 191, 191, 191, 191, 191, 191, 193, 200, 201, 203, 199, 195, 191, 205, 199, 199, 191, 203, 199, 204, 201, 214, 199, 
    203, 205, 207, 207, 207, 206, 205, 199, 207, 208, 207, 206, 207, 207, 207, 207, 208, 207, 199, 211, 207, 207, 209, 215, 
    208, 211, 207, 207, 217, 207, 211, 215, 220, 214, 211, 215, 215, 220, 219, 220, 215, 215, 215, 216, 211, 215, 219, 223, 
    223, 223, 223, 225, 223, 223, 223, 223, 223, 227, 223, 223, 223, 223, 221, 223, 223, 223, 223, 223, 223, 223, 221, 223, 
    227, 231, 223, 231, 223, 223, 231, 239, 231, 231, 231, 227, 226, 231, 231, 231, 231, 231, 239, 235, 235, 227, 234, 233, 
    239, 236, 239, 237, 239, 239, 235, 239, 231, 239, 240, 237, 239, 239, 238, 243, 243, 239, 243, 246, 243, 243, 235, 239, 
    239, 239, 247, 241, 247, 247, 248, 248, 247, 239, 247, 237, 247, 253, 243, 253, 253, 255, 254, 251, 250, 255, 255, 255, 
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 
    255, 255, 255, 255, 255, 255, 263, 265, 263, 263, 255, 255, 255, 255, 275, 264, 267, 255, 255, 255, 255, 262, 271, 267, 
    263, 271, 272, 271, 267, 255, 255, 255, 263, 271, 255, 255, 263, 263, 271, 255, 255, 271, 272, 271, 271, 271, 271, 267, 
    271, 271, 267, 271, 273, 271, 271, 271, 271, 267, 279, 274, 271, 271, 271, 271, 271, 272, 271, 275, 271, 279, 271, 271, 
    279, 284, 279, 279, 271, 279, 279, 279, 281, 279, 279, 283, 277, 282, 280, 276, 287, 281, 279, 287, 287, 283, 287, 287, 
    287, 287, 287, 287, 289, 287, 287, 287, 287, 283, 294, 287, 287, 287, 287, 289, 295, 287, 295, 295, 295, 298, 287, 287, 
    289, 295, 291, 289, 295, 291, 295, 294, 295, 295, 295, 296, 295, 299, 298, 295, 295, 296, 297, 303, 299, 297, 302, 303, 
    307, 301, 303, 299, 303, 305, 303, 303, 303, 305, 306, 307, 303, 303, 305, 310, 319, 306, 311, 312, 311, 310, 311, 311, 
    310, 308, 311, 311, 311, 314, 311, 304, 311, 311, 312, 319, 315, 314, 315, 319, 319, 319, 319, 319, 319, 319, 319, 319, 
    319, 319, 319, 319, 319, 319, 319, 319, 319, 318, 324, 319, 323, 319, 319, 325, 323, 325, 319, 319, 319, 327, 327, 319, 
    319, 324, 324, 328, 319, 319, 324, 319, 325, 334, 324, 319, 319, 327, 323, 319, 327, 319, 327, 325, 330, 327, 327, 327, 
    329, 333, 335, 325, 327, 329, 327, 335, 335, 333, 328, 330, 335, 335, 335, 327, 335, 335, 335, 335, 331, 335, 341, 335, 
    335, 335, 343, 337, 335, 335, 335, 335, 343, 335, 341, 343, 341, 343, 339, 343, 339, 341, 339, 339, 346, 343, 346, 345, 
    343, 347, 351, 351, 351, 351, 351, 351, 351, 351, 352, 343, 350, 353, 351, 349, 353, 353, 347, 351, 355, 351, 354, 355, 
    359, 351, 351, 359, 355, 350, 357, 351, 356, 354, 366, 359, 355, 353, 357, 356, 352, 367, 359, 360, 359, 362, 357, 364, 
    359, 359, 367, 359, 367, 366, 359, 359, 367, 360, 365, 367, 359, 367, 365, 368, 368, 364, 375, 375, 368, 367, 373, 363, 
    371, 376, 368, 375, 375, 374, 373, 373, 370, 368, 371, 369, 369, 375, 376, 375, 379, 380, 378, 379, 376, 378, 379, 377, 
    373, 380, 377, 382, 383, 383, 383, 383, 383, 383, 383, 383, 383, 389, 383, 383, 383, 383, 383, 383, 383, 383, 383, 384, 
    383, 391, 391, 391, 383, 391, 391, 391, 391, 383, 383, 383, 391, 391, 391, 383, 383, 383, 383, 383, 387, 391, 391, 399, 
    390, 385, 396, 383, 393, 383, 391, 389, 391, 393, 390, 383, 391, 391, 391, 391, 391, 396, 396, 399, 398, 395, 398, 399, 
    399, 399, 399, 399, 399, 399, 406, 408, 405, 399, 399, 406, 403, 405, 399, 400, 401, 414, 401, 408, 406, 400, 407, 407, 
    410, 403, 401, 405, 404, 399, 407, 411, 407, 408, 407, 407, 414, 414, 411, 407, 413, 411, 414, 415, 415, 411, 411, 415, 
    415, 413, 418, 415, 415, 415, 415, 415, 415, 415, 414, 418, 416, 420, 417, 423, 417, 415, 417, 424, 421, 424, 424, 421, 
    423, 423, 418, 415, 418, 426, 415, 426, 425, 424, 431, 429, 419, 428, 425, 423, 429, 427, 427, 425, 429, 431, 431, 424, 
    427, 424, 431, 434, 435, 427, 436, 431, 431, 431, 431, 427, 431, 432, 431, 437, 431, 433, 435, 435, 431, 437, 432, 439, 
    439, 437, 440, 437, 439, 439, 440, 440, 439, 439, 438, 433, 445, 439, 440, 443, 446, 445, 446, 447, 447, 447, 447, 447, 
    447, 446, 449, 447, 447, 447, 447, 447, 447, 447, 447, 447, 451, 449, 447, 451, 452, 453, 455, 447, 451, 453, 453, 451, 
    455, 449, 451, 456, 455, 448, 463, 455, 451, 455, 456, 460, 448, 460, 452, 458, 450, 451, 456, 456, 454, 456, 454, 454, 
    455, 455, 455, 455, 455, 461, 463, 458, 461, 463, 463, 460, 455, 463, 459, 461, 463, 461, 467, 457, 463, 464, 461, 463, 
    459, 466, 469, 465, 469, 469, 467, 462, 466, 460, 467, 469, 466, 470, 471, 472, 466, 467, 471, 463, 471, 469, 471, 471, 
    473, 472, 475, 479, 479, 477, 479, 471, 479, 478, 474, 479, 472, 475, 479, 480, 479, 482, 480, 480, 480, 480, 480, 479, 
    480, 479, 479, 475, 479, 479, 485, 483, 477, 481, 479, 483, 479, 484, 480, 485, 487, 485, 486, 483, 486, 483, 487, 483, 
    484, 484, 484, 487, 488, 488, 488, 483, 488, 495, 494, 498, 493, 495, 492, 495, 495, 495, 488, 495, 495, 497, 497, 499, 
    492, 495, 495, 500, 495, 489, 503, 500, 501, 504, 500, 499, 496, 501, 504, 501, 504, 497, 501, 504, 502, 503, 502, 499, 
    503, 497, 495, 508, 506, 505, 506, 508, 505, 508, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 
    511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 511, 
    511, 511, 511, 511, 511, 511, 511, 504, 521, 511, 501, 522, 511, 503, 499, 521, 511, 501, 503, 522, 519, 511, 505, 503, 
    509, 508, 507, 504, 503, 527, 523, 525, 523, 527, 521, 525, 527, 527, 529, 527, 527, 528, 525, 527, 532, 527, 529, 529, 
    533, 531, 527, 527, 530, 527, 531, 532, 535, 535, 533, 532, 533, 535, 535, 535, 539, 535, 533, 535, 535, 535, 535, 533, 
    535, 541, 540, 511, 511, 511, 511, 511, 511, 519, 542, 541, 511, 520, 541, 511, 511, 519, 511, 532, 546, 511, 523, 543, 
    513, 543, 517, 519, 519, 521, 543, 519, 520, 519, 523, 523, 519, 511, 527, 523, 524, 521, 523, 523, 524, 524, 527, 527, 
    529, 527, 529, 523, 527, 528, 527, 527, 528, 524, 527, 527, 527, 531, 527, 527, 530, 529, 531, 531, 531, 527, 527, 529, 
    531, 531, 527, 527, 527, 527, 535, 534, 535, 535, 531, 535, 533, 535, 537, 536, 535, 535, 535, 535, 543, 540, 535, 535, 
    541, 536, 538, 535, 538, 539, 539, 541, 539, 541, 543, 543, 543, 543, 543, 543, 539, 543, 538, 543, 544, 541, 543, 545, 
    543, 546, 544, 544, 543, 551, 549, 543, 543, 543, 546, 550, 546, 547, 550, 547, 551, 547, 549, 543, 547, 547, 547, 547, 
    547, 549, 552, 543, 551, 547, 551, 550, 552, 551, 551, 552, 552, 552, 551, 551, 555, 555, 551, 551, 555, 555, 559, 559, 
    559, 559, 554, 559, 559, 559, 559, 562, 562, 559, 558, 564, 559, 559, 561, 563, 559, 559, 559, 560, 565, 561, 563, 561, 
    560, 567, 559, 567, 567, 567, 567, 567, 567, 570, 567, 569, 567, 569, 575, 571, 572, 568, 570, 571, 568, 575, 572, 568, 
    567, 574, 575, 567, 573, 575, 575, 575, 571, 575, 575, 575, 575, 582, 575, 575, 575, 577, 575, 571, 575, 578, 581, 575, 
    575, 575, 575, 583, 579, 575, 577, 579, 579, 582, 579, 583, 575, 581, 582, 577, 584, 580, 584, 587, 583, 585, 591, 588, 
    584, 583, 584, 583, 582, 583, 583, 591, 588, 587, 587, 591, 590, 590, 590, 591, 593, 593, 589, 591, 591, 593, 596, 591, 
    597, 596, 592, 599, 596, 600, 599, 598, 596, 592, 597, 596, 600, 599, 599, 600, 597, 599, 600, 602, 605, 607, 599, 599, 
    598, 605, 607, 603, 607, 608, 607, 607, 610, 607, 605, 604, 607, 607, 606, 612, 615, 616, 610, 612, 610, 607, 608, 613, 
    612, 615, 616, 609, 615, 612, 609, 616, 613, 612, 615, 615, 616, 615, 615, 615, 623, 620, 620, 623, 622, 620, 620, 623, 
    617, 619, 623, 628, 623, 623, 623, 623, 625, 623, 627, 623, 628, 624, 628, 627, 627, 623, 631, 634, 628, 631, 631, 627, 
    627, 626, 627, 627, 633, 637, 639, 640, 633, 639, 638, 639, 637, 635, 639, 623, 639, 639, 639, 633, 643, 639, 639, 646, 
    639, 650, 643, 639, 639, 639, 639, 639, 639, 645, 647, 647, 635, 645, 654, 639, 644, 643, 642, 651, 643, 641, 643, 645, 
    643, 647, 647, 643, 639, 654, 648, 656, 654, 655, 655, 652, 652, 650, 652, 647, 649, 650, 651, 658, 655, 655, 660, 663, 
    655, 664, 655, 657, 655, 655, 663, 655, 663, 661, 659, 657, 663, 664, 660, 670, 667, 664, 665, 665, 663, 668, 663, 667, 
    665, 667, 670, 668, 664, 675, 673, 668, 674, 666, 678, 669, 672, 674, 675, 677, 675, 671, 671, 667, 670, 671, 677, 676, 
    674, 672, 673, 677, 679, 679, 679, 678, 677, 675, 688, 684, 684, 682, 679, 683, 686, 681, 684, 686, 690, 683, 687, 687, 
    688, 684, 688, 684, 687, 688, 687, 690, 686, 692, 689, 696, 694, 689, 694, 689, 688, 695, 695, 696, 692, 692, 696, 698, 
    698, 702, 696, 694, 696, 700, 696, 693, 700, 702, 702, 703, 703, 701, 695, 693, 703, 701, 703, 712, 703, 702, 700, 708, 
    708, 707, 707, 703, 707, 709, 703, 706, 701, 703, 707, 708, 707, 711, 711, 707, 710, 703, 708, 716, 707, 712, 719, 712, 
    713, 715, 712, 716, 711, 714, 716, 715, 721, 716, 717, 712, 717, 720, 711, 720, 717, 722, 721, 719, 720, 723, 719, 719, 
    719, 727, 727, 727, 724, 718, 714, 727, 727, 728, 727, 728, 727, 725, 728, 724, 721, 731, 732, 726, 727, 736, 732, 735, 
    729, 735, 730, 735, 726, 732, 735, 734, 740, 735, 736, 740, 741, 737, 737, 742, 728, 736, 736, 735, 735, 735, 741, 743, 
    736, 740, 744, 743, 740, 742, 735, 740, 737, 739, 743, 752, 749, 748, 750, 745, 747, 745, 744, 742, 749, 747, 749, 752, 
    751, 749, 747, 750, 750, 751, 747, 752, 754, 752, 757, 757, 752, 759, 757, 744, 751, 757, 758, 759, 756, 755, 756, 751, 
    763, 765, 764, 764, 760, 761, 757, 758, 759, 762, 767, 767, 767, 767, 767, 767, 767, 766, 766, 765, 767, 771, 767, 767, 
    764, 767, 767, 767, 773, 772, 775, 775, 773, 773, 773, 776, 767, 766, 763, 772, 779, 775, 767, 766, 765, 763, 767, 772, 
    780, 780, 771, 777, 767, 767, 767, 771, 786, 783, 775, 775, 775, 774, 772, 767, 775, 767, 783, 781, 781, 783, 783, 775, 
    779, 782, 782, 780, 783, 785, 784, 782, 784, 783, 784, 782, 783, 782, 791, 785, 786, 783, 783, 789, 786, 787, 783, 780, 
    791, 792, 796, 791, 788, 788, 787, 785, 793, 793, 791, 799, 797, 796, 791, 793, 792, 791, 800, 799, 799, 799, 799, 800, 
    795, 801, 803, 803, 795, 802, 805, 802, 799, 800, 803, 796, 796, 808, 806, 802, 804, 801, 804, 806, 799, 801, 808, 814, 
    809, 807, 807, 804, 806, 808, 807, 806, 800, 810, 811, 813, 814, 807, 810, 810, 810, 809, 807, 814, 815, 815, 815, 813, 
    815, 815, 815, 813, 822, 820, 816, 812, 820, 812, 816, 819, 816, 811, 812, 818, 823, 824, 821, 818, 818, 820, 823, 823, 
    828, 826, 825, 824, 827, 827, 825, 826, 822, 827, 824, 828, 827, 822, 830, 831, 831, 831, 831, 824, 825, 831, 835, 837, 
    828, 835, 833, 831, 825, 837, 832, 836, 831, 838, 829, 831, 833, 836, 833, 835, 833, 844, 837, 838, 840, 831, 836, 844, 
    833, 835, 838, 835, 839, 842, 840, 842, 839, 842, 832, 831, 856, 840, 845, 847, 839, 846, 841, 840, 850, 849, 848, 848, 
    842, 846, 843, 847, 851, 852, 845, 850, 850, 846, 846, 862, 855, 850, 845, 852, 852, 853, 855, 856, 857, 851, 855, 858, 
    849, 860, 854, 858, 855, 858, 854, 855, 858, 853, 856, 857, 856, 858, 858, 861, 861, 866, 855, 863, 851, 860, 866, 867, 
    864, 866, 860, 863, 863, 861, 863, 865, 867, 857, 869, 863, 872, 867, 868, 865, 866, 868, 875, 870, 864, 863, 871, 869, 
    867, 878, 880, 871, 872, 878, 871, 874, 872, 877, 872, 871, 875, 866, 871, 875, 879, 879, 877, 874, 878, 874, 877, 884, 
    880, 874, 878, 887, 880, 884, 882, 871, 884, 878, 879, 879, 884, 875, 888, 887, 884, 889, 887, 887, 889, 890, 887, 888, 
    887, 885, 887, 887, 888, 887, 887, 884, 887, 886, 887, 896, 888, 895, 887, 886, 893, 895, 885, 893, 888, 889, 897, 895, 
    903, 900, 896, 895, 895, 895, 895, 895, 892, 899, 886, 904, 905, 895, 900, 892, 893, 897, 911, 897, 904, 900, 899, 899, 
    895, 897, 892, 912, 914, 903, 903, 901, 903, 903, 899, 903, 908, 915, 904, 904, 906, 909, 902, 910, 909, 912, 907, 912, 
    905, 907, 911, 910, 911, 918, 907, 910, 909, 907, 907, 915, 924, 920, 912, 909, 915, 916, 915, 916, 911, 915, 908, 916, 
    923, 917, 924, 924, 918, 921, 916, 924, 919, 926, 922, 918, 918, 917, 919, 927, 930, 929, 927, 922, 920, 924, 924, 922, 
    921, 923, 928, 926, 928, 926, 921, 923, 927, 927, 931, 927, 926, 921, 927, 931, 932, 926, 927, 930, 925, 932, 932, 937, 
    931, 934, 932, 933, 936, 933, 934, 942, 944, 933, 940, 939, 941, 938, 934, 936, 931, 935, 948, 939, 936, 943, 944, 940, 
    940, 935, 936, 937, 949, 940, 947, 944, 948, 942, 943, 943, 941, 938, 951, 943, 950, 951, 948, 946, 945, 947, 947, 949, 
    947, 950, 952, 952, 953, 951, 953, 952, 949, 957, 958, 949, 956, 956, 957, 956, 952, 959, 960, 957, 953, 951, 953, 949, 
    954, 967, 965, 956, 953, 966, 952, 959, 958, 969, 965, 968, 960, 960, 960, 964, 965, 959, 959, 959, 960, 968, 965, 961, 
    966, 959, 966, 964, 966, 963, 966, 968, 968, 965, 966, 967, 961, 967, 973, 972, 968, 967, 968, 976, 970, 975, 969, 969, 
    970, 966, 972, 973, 975, 973, 967, 970, 966, 980, 980, 975, 975, 971, 972, 974, 977, 985, 982, 981, 977, 975, 976, 977, 
    973, 984, 989, 982, 984, 979, 984, 986, 978, 983, 978, 983, 981, 992, 992, 988, 983, 984, 986, 990, 982, 984, 986, 993, 
    991, 996, 992, 998, 983, 995, 993, 989, 989, 990, 996, 988, 990, 990, 986, 990, 1000
]

expected = [0.3097 * i + 47.353 for i in range(len(samples))]

residuals = [samples[i] - expected[i] for i in range(len(samples))]

plt.subplot(1, 2, 1)
plt.plot(range(len(samples)), expected, color='tab:red', label='Expected')
plt.scatter(range(len(samples)), samples, marker='.')
plt.grid(color='gray', linestyle='--', linewidth=0.5)
plt.legend()
plt.xlabel("Time [s]")
plt.ylabel("ADC Output [LSB]")
plt.title("ADC Data")

plt.subplot(1, 2, 2)
plt.axhline(color='black', linewidth=0.5)
plt.scatter(range(len(samples)), residuals, marker='.')
plt.grid(color='gray', linestyle='--', linewidth=0.5)
plt.xlabel("Time [s]")
plt.ylabel("Residual [LSB]")
plt.title("ADC Data Residuals")

plt.show()
